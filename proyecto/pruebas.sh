#!/bin/bash
# una barra de progreso en bash
# por ratoncio
# ver. 0.2
 
if [ $# -gt 1 ];then
    BARLENGTH=`echo $2-1|bc`
    SPEED=0.1
    DELCAR="\\x08"
    PID=$1
    BARCAR="-"
    CAR="0"
    CONT=0
    SWITCH=0
    for i in `seq 0 $BARLENGTH`;do
        BAR=$BAR$BARCAR
        DEL=$DEL$DELCAR
    done
     
    while [ -d /proc/$PID ];do
        if [ $SWITCH -eq 0 ];then
            echo -en "${BAR:0:$CONT}$CAR${BAR:$CONT+1:$BARLENGTH}" && sleep $SPEED && echo -en $DEL
            CONT=`echo $CONT + 1|bc`
        else
            echo -en "${BAR:0:$CONT}$CAR${BAR:$CONT+1:$BARLENGTH}" && sleep $SPEED && echo -en $DEL
            CONT=`echo $CONT - 1|bc`
        fi
        if [ $CONT -eq $BARLENGTH -o $CONT -eq 0 ];then
            if [ $SWITCH -eq 0 ];then
                SWITCH=1
            else
                SWITCH=0
            fi
        fi
    done
    echo -en $DEL"        "$DEL
    exit 0
else
        echo "progbar <pid> <longitudbarra>"
        exit 1
fi
